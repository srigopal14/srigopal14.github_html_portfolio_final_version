<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DIY Bubble Game | Sriya Gopalan</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;800&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.6.0/p5.min.js"></script>

<style>
body {
  font-family: 'Inter', sans-serif;
  background:#f8f9fa;
  margin:0;
}
.project-header {
  background:#1b3a6b;
  color:white;
  text-align:center;
  padding:5rem 0;
}
.project-section {
  background:white;
  border-radius:2rem;
  box-shadow:0 0.5rem 1rem rgba(0,0,0,.15);
  padding:2rem;
  max-width:900px;
  margin:3rem auto;
}
#game-canvas canvas {
  display:block;
  margin:auto;
  border-radius:12px;
}
footer {
  background:#343a40;
  color:white;
  text-align:center;
  padding:1.5rem 0;
}
</style>
</head>

<body>

<header class="project-header">
  <h1 class="display-4 fw-bold">DIY Bubble Game</h1>
  <p class="lead opacity-75">Pop bubbles ‚Äî avoid bombs!</p>
</header>

<main class="project-section">
  <ul>
    <li>‚ú® Sparkle bubbles = bonus points + time</li>
    <li>üí£ Bombs remove lives</li>
    <li>‚è±Ô∏è Timer increases with bonuses</li>
  </ul>
  <div id="game-canvas"></div>
</main>

<footer>¬© 2025 Sriya Gopalan</footer>

<script>
let objects=[], explosions=[], pops=[];
let score=0, lives=5, totalObjects=15;
let winScore=100, timer=90;
const MAX_TIME=120;
const BONUS_TIME=10;

let gameStarted=false, gameWon=false, gameLost=false;

function setup(){
  let c=createCanvas(600,400);
  c.parent("game-canvas");
}

function draw(){
  background(30,30,50);

  if(!gameStarted){
    drawButton(width/2,height/2,180,60,"PLAY");
    return;
  }

  if(!gameWon && !gameLost){
    timer -= deltaTime/1000;
    if(timer<=0) gameLost=true;
  }

  if(gameWon){ displayWinScreen(); return; }
  if(gameLost){ displayLoseScreen(); return; }

  // HUD background
  noStroke();
  fill(0, 0, 0, 120);
  rect(30, 10, 160, 70, 10);

  // HUD text
  fill(255);
  textSize(16);
  textAlign(LEFT);
  text(`Score: ${score}`, 40, 30);
  text(`Lives: ${lives}`, 40, 50);
  text(`Time: ${ceil(timer)}s`, 40, 70);

  for(let o of objects){ o.move(); o.show(); }
  explosions = explosions.filter(e=>!e.update());
  pops = pops.filter(p=>!p.update());
}

function mousePressed(){
  if(!gameStarted){
    if(overButton(width/2,height/2,180,60)){
      gameStarted=true;
      startGame();
    }
    return;
  }

  if(gameWon || gameLost){
    if(overButton(width/2,height/2+40,220,60)){
      startGame();
    }
    return;
  }

  for(let i=objects.length-1;i>=0;i--){
    if(objects[i].clicked(mouseX,mouseY)){
      objects[i].onClick();
      objects.splice(i,1);
      objects.push(new GameObject());
      break;
    }
  }
}

function startGame(){
  objects=[];
  explosions=[];
  pops=[];
  score=0;
  lives=5;
  timer=90;
  gameWon=gameLost=false;
  for(let i=0;i<totalObjects;i++) objects.push(new GameObject());
}

function drawButton(x,y,w,h,label){
  rectMode(CENTER);
  fill("#2563eb");
  rect(x,y,w,h,12);
  fill(255);
  textAlign(CENTER,CENTER);
  textSize(24);
  text(label,x,y);
}

function overButton(x,y,w,h){
  return mouseX>x-w/2 && mouseX<x+w/2 && mouseY>y-h/2 && mouseY<y+h/2;
}

/* ---------- END SCREENS ---------- */
function displayLoseScreen(){
  background(20);
  fill(255,80,80);
  textSize(34);
  textAlign(CENTER);
  text("You hit all 5 bombs!",width/2,height/2-40);
  fill(255);
  textSize(22);
  text(`Final Score: ${score}`,width/2,height/2);
  drawButton(width/2,height/2+40,220,60,"PLAY AGAIN");
}

function displayWinScreen(){
  background(20,40,30);
  fill(120,255,180);
  textSize(38);
  textAlign(CENTER);
  text("üéâ You won!",width/2,height/2-40);
  fill(255);
  textSize(22);
  text(`Final Score: ${score}`,width/2,height/2);
  drawButton(width/2,height/2+40,220,60,"PLAY AGAIN");
}

/* ---------- GAME OBJECT ---------- */
class GameObject{
  constructor(){ this.reset(); }

  reset(){
    this.r=random(20,35);
    this.x=random(this.r,width-this.r);
    this.y=random(height+this.r,height+200);
    this.speed=random(1,3);

    this.isBomb=random()<0.2;
    this.isSparkle=!this.isBomb && random()<0.25;

    this.col=color(random(100,255),random(100,255),random(100,255),180);
  }

  move(){
    this.y-=this.speed;
    if(this.y<-this.r) this.reset();
  }

  show(){
    if(this.isBomb){
      drawBomb(this.x,this.y,this.r);
    } else {
      noStroke();
      fill(this.col);
      ellipse(this.x,this.y,this.r*2);
      if(this.isSparkle) drawSparkle(this.x,this.y,this.r);
    }
  }

  clicked(px,py){
    return dist(px,py,this.x,this.y)<this.r;
  }

  onClick(){
    if(this.isBomb){
      explosions.push(new Explosion(this.x,this.y));
      lives--;
      if(lives<=0) gameLost=true;
    } else {
      pops.push(new PopEffect(this.x,this.y));
      score += this.isSparkle ? 3 : 1;
      if(this.isSparkle){
        timer=min(timer+BONUS_TIME,MAX_TIME);
      }
      if(score>=winScore) gameWon=true;
    }
  }
}

/* ---------- VISUAL EFFECTS ---------- */
function drawSparkle(x,y,r){
  stroke(255,255,150);
  for(let a=0;a<TWO_PI;a+=PI/4){
    let d=r+sin(frameCount*0.2)*4;
    line(x,y,x+cos(a)*d,y+sin(a)*d);
  }
}

function drawBomb(x,y,r){
  fill(40);
  ellipse(x,y,r*2);
  stroke(200);
  line(x,y-r,x,y-r-10);
  fill(255,150,0);
  ellipse(x,y-r-12,6+sin(frameCount*0.3)*2);
}

class Explosion{
  constructor(x,y){ this.x=x; this.y=y; this.f=0; }
  update(){
    this.f++;
    fill(255,150,0,200-this.f*15);
    noStroke();
    ellipse(this.x,this.y,this.f*6);
    return this.f>12;
  }
}

class PopEffect{
  constructor(x,y){ this.x=x; this.y=y; this.f=0; }
  update(){
    this.f++;
    stroke(255,255-this.f*20);
    noFill();
    ellipse(this.x,this.y,this.f*4);
    return this.f>10;
  }
}
</script>

</body>
</html>
